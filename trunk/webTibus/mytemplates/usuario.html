{% extends "baseMenu.html" %}

{% block content %}
<table style="text-align: left; height: 100%; width: 90%;border: 3px solid rgb(0,0,0); padding:10px; box-shadow: 0px 0px 10px 10px rgba(70,70,70, 0.4) inset;background-color:rgb(255,255,255);">
    <tr>
        <td style="text-align: left; height: 100%; width: 50%;"><table style="text-align: left; height: 100%; width: 100%;" cellpadding="2" cellspacing="2">
        <tr><td>Usuarios Existentes: </td></tr>
        <tr><td><table style="text-align: left; height: 100%; width: 100%;">
        {% if listaUsuarios %}
        <tr><td> Nombre</td><td> Email  </td><td> Categoria  </td><td> Empresa  </td></tr>
        {% for usuario in listaUsuarios %}<tr><td>{{ usuario.nombre }}</td><td>{{ usuario.mail}}</td><td>{{ usuario.categoria }}</td><td>{{ usuario.empresa }}</td></tr>{% endfor %}
        {% else %}<tr><td>No hay usuarios disponibles.</td></tr>
        {% endif %}
        </table></td></tr>
        </table></td>
    <td><table><tbody>
    {% if error %}<tr style="height: 20%; width: 100%;"><td style="text-align: center;"><font color="red" size=4>Error: {{ error }}</font></td></tr>{% endif %}    
       <tr><form name="formUsuario" action="" method="post">{% csrf_token %}
            <table>
                <tr>
                    <td> <label for="id_usuario"> Nombre Usuario: </label> {{ form.nombre }} </td>	
                    <td> <BUTTON type="submit" name="accion" value="viewUsuario"> Buscar Usuario </BUTTON> </td>
                </tr>
                <tr>
                    <td> <label for="password"> Contraseña: </label> {{ form.password }} </td>
                    <td> <label for="confirmacion"> Confirmar Contraseña: </label> {{ form.confirmacion }} </td>
                    <td> <label for="email"> Email: </label> {{ form.email }} </td>
                </tr>
                <tr>
                    <td> <label for="categoria"> Categoria: </label> {{ form.categoria }} 
                    <SELECT NAME="tipoCombo" SIZE=1 onchange="document.formUsuario.id_categoria.value = document.formUsuario.tipoCombo.options[document.formUsuario.tipoCombo.selectedIndex].value;document.formUsuario.tipoCombo.value=''">> 
                        {% for categoria in listaCategoria %}
                            <OPTION VALUE="{{ categoria }}">{{ categoria }}</OPTION>
                        {% endfor %}
                    </SELECT></td>
                    <td> <label for="empresa"> Empresa: </label> {{ form.empresa }} 
                    <SELECT NAME="empresaCombo" SIZE=1 onchange="document.formUsuario.id_empresa.value = document.formUsuario.empresaCombo.options[document.formUsuario.empresaCombo.selectedIndex].value;document.formUsuario.empresaCombo.value=''">> 
                        {% for empresa in listaEmpresa %}
                            <OPTION VALUE="{{ empresa.nombre }}">{{ empresa.nombre }}</OPTION>
                        {% endfor %}
                        </SELECT></td>
                </tr></table>
                <BUTTON type="submit" name="accion" value="addUsuario"> Agregar Usuario </BUTTON>
                <BUTTON type="submit" name="accion" value="editUsuario"> Modificar Usuario </BUTTON>
                <BUTTON type="submit" name="accion" value="rehabUsuario"> Rehabilitar Usuario </BUTTON>
                <BUTTON type=button name="accion" onclick="pregunta()" value="delUsuario" > Eliminar Usuario </BUTTON>
            </form></tr>
        </tbody></table>
    </td></tr>
</table>
{% endblock %}

{% block extrahead %}
<script type="text/javascript">
    function pregunta(){
        if (confirm("Esta seguro de querer eliminar este registro?")){
            document.formUsuario.accion = "delUsuario"
            document.formUsuario.submit();
        }
    }</script>{% endblock %}