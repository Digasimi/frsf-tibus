{% extends "baseMenu.html" %}

{% block content %}
<table style="text-align: left; height: 100%; width: 90%;border: 3px solid rgb(0,0,0); padding:10px; box-shadow: 0px 0px 10px 10px rgba(70,70,70, 0.4) inset;background-color:rgb(255,255,255);">
    <tr>
        <td style="text-align: center; height: 100%; width: 50%;"align=center >
        <a>Usuarios Existentes</a>
        <div id="tableContainer" class="tableContainer">
        {% if userList %}
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="scrollTable">
			<thead class="fixedHeader">
				<tr>
					<th><a href="#">Nombre</a></th>
					<th><a href="#">Email</a></th>
					<th><a href="#">Categoria</a></th>
					<th><a href="#">Empresa</a></th>
				</tr>
			</thead>
			<tbody class="scrollContent">
			{% for user in userList %}
			<tr>
				<td>{{ user.nombre }}</td>
				<td>{{ user.mail}}</td>
				<td>{{ user.categoria }}</td>
				<td>{{ user.empresa }}</td>
			</tr>
			{% endfor %}
			</tbody></table>
        {% else %}<tr><td>No hay usuarios disponibles.</td></tr>
        {% endif %}
		</div></td>
    	<td><table><tbody>
    	{% if error %} <tr><td style="text-align: center;"><font color="red" size=2>Error: {{ error }}</font></td></tr>{% endif %}
       	<tr><form name="formUsuario" action="" method="post">{% csrf_token %}
            <table>
                <tr>
                    <td colspan="2"> <label for="id_usuario"> Nombre Usuario: </label> {{ form.nombre }} </td>	
                    <!--  <td> <BUTTON type="submit" name="accion" value="viewUsuario"> Buscar Usuario </BUTTON> </td>-->
                </tr>
                <tr>
                    <td> <label for="password"> Contraseña: </label> {{ form.password }} </td>
                    <td> <label for="confirmacion"> Confirmar Contraseña: </label> {{ form.confirmacion }} </td>
                </tr>
                <tr>
                    <td> <label for="email"> Email: </label> {{ form.email }} </td>
                </tr>
                <tr>
                    <td> <label for="categoria"> Categoria: </label> {{ form.categoria }} 
                    <SELECT NAME="tipoCombo" SIZE=1 onchange="document.formUsuario.id_categoria.value = document.formUsuario.tipoCombo.options[document.formUsuario.tipoCombo.selectedIndex].value;document.formUsuario.tipoCombo.value=document.formUsuario.tipoCombo.options[document.formUsuario.tipoCombo.selectedIndex].value">
                     		<OPTION VALUE="">Seleccione un valor</OPTION>
                        {% for category in categoryList %}
                            <OPTION VALUE="{{ category }}">{{ category }}</OPTION>
                        {% endfor %}
                    </SELECT></td>
                    <td> <label for="empresa"> Empresa: </label> {{ form.empresa }} 
                    <SELECT NAME="empresaCombo" SIZE=1 onchange="document.formUsuario.id_empresa.value = document.formUsuario.empresaCombo.options[document.formUsuario.empresaCombo.selectedIndex].value;document.formUsuario.empresaCombo.value=document.formUsuario.empresaCombo.options[document.formUsuario.empresaCombo.selectedIndex].value">
                    		<OPTION VALUE="">Seleccione un valor</OPTION> 
                        {% for company in companyList %}
                            <OPTION VALUE="{{ company.nombre }}">{{ company.nombre }}</OPTION>
                        {% endfor %}
                        </SELECT></td>
                </tr></table>
                <BUTTON type="submit" name="action" value="addUser"> Agregar Usuario </BUTTON>
                <BUTTON type="submit" name="action" value="editUser"> Modificar Email Usuario </BUTTON>
                <BUTTON type="submit" name="action" value="rehabUser"> Rehabilitar Usuario </BUTTON>
                <BUTTON type=button name="action" onclick="confirmation()" value="delUser" > Eliminar Usuario </BUTTON>
            </form></tr>
        </tbody></table>
    </td></tr>
</table>
{% endblock %}

{% block extrahead %}
<script type="text/javascript">
    function confirmation(){
        if (confirm("Esta seguro de querer eliminar este registro?")){
            document.formUsuario.action = "delUser"
            document.formUsuario.submit();
        }
    }</script>{% endblock %}